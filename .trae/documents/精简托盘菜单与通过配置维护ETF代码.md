## 改造目标

1. 系统托盘菜单仅保留“退出”，去除其它所有选项与交互。
2. ETF/股票代码仅由配置文件维护（手动编辑 `config.json` 的 `etf_list`），移除界面中对代码的新增/删除入口。
3. 保持程序能后台运行与数据刷新，整体更简化、后续维护更方便。

## 代码改动点

### 托盘菜单精简

* 编辑 `src/ui/tray_icon.py:116-152` 的 `CreatePopupMenu`：

  * 删除“查看所有基金”（`src/ui/tray_icon.py:135-139`）与“设置...”菜单项（`src/ui/tray_icon.py:142-145`）。

  * 仅保留“退出”（`src/ui/tray_icon.py:149-150`），确保绑定 `_on_exit`。

* 回调注册精简：在 `src/app.py:144-153` 去除对“设置/详情/关于/手动刷新/暂停/自启/菜单开关”等托盘回调的绑定，仅保留退出相关绑定。

* 菜单打开/关闭联动：如不再需要，可移除 `src/ui/tray_icon.py:123-134, 377-384` 与 `src/app.py:346-356` 的守护暂停/恢复逻辑。

* 可选：取消托盘左键双击行为（打开详情），在 `src/ui/tray_icon.py:88-90, 297-306` 处移除绑定或让处理函数不执行任何操作。

### ETF 代码仅配置维护

* 配置保持为 JSON，继续使用 `src/config/manager.py` 管理（已支持 `config.json` 与校验）：

  * `DEFAULT_CONFIG` 中的 `etf_list` 字段保留（`src/config/manager.py:35-42, 75-91`）。

  * 加载位置保持不变（`src/app.py:38-41, 74-82, 111-133`）。

* 设置对话框中移除 ETF 列表的 UI 与交互：

  * 去除 ETF 管理面板与导航项（`src/ui/settings_dialog.py:317-321, 342-354`）。

  * 删除 ETF 列表控件与添加/删除/清空按钮（`src/ui/settings_dialog.py:434-522`）。

  * 删除相关事件与方法：`_on_add_etf`（`899-945`）、`_on_delete_etf`（`946-953`）、`_on_clear_etf`（`954-967`）、`_refresh_etf_list`（`1049-1058`）。

  * 保存逻辑中不再写入 `etf_list`（调整 `src/ui/settings_dialog.py:968-1005`）。

* 其它设置（如刷新/轮播/自启）按需保留；若目标是进一步简化 UI，可整体隐藏设置入口（与上文“托盘菜单精简”同步）。

## 配置与维护方式

* 在仓库根目录的 `config.json` 中编辑 `etf_list`：例如 `"etf_list": ["512170", "XXXXXX"]`。

* 程序启动时自动读取；运行中如需变更，可重启程序或保留“重载配置”逻辑（`src/app.py:383-398`）。

## 验证步骤

* 开发环境启动：在根目录执行 `python main.py`（入口见 `main.py:19-41, 64-65`）。

* 托盘验证：右键托盘图标，仅显示“退出”；点击退出应正常关闭。

* 行为验证：

  * 若保留双击，确认双击不再弹出任何窗口（或按保留策略验证）。

  * 日志中打印加载到的 `etf_list`，数据抓取正常运行（`src/app.py:111-133`）。

* 配置验证：修改 `config.json` 的 `etf_list` 后重启，确认新列表生效。

* 打包验证：使用 `build.ps1` 或 `pyinstaller build.spec` 生成可执行文件，运行并重复上述验证。

## 影响评估

* UI 简化：托盘与设置对话框的相关功能被移除，用户只能通过配置文件维护代码并退出程序。

* 代码依赖：删除菜单项与设置面板后，需清理未使用的回调与导入，避免引用错误。

* 维护性：配置与逻辑留在 `manager.py/app.py`，后续仅需编辑 `config.json`。

## 交付内容

* 修改后的 `tray_icon.py`、`app.py`、`settings_dialog.py`，确保仅保留退出菜单、ETF 列表改为配置维护。

* 更新后的默认配置（如需），并在提交说明中标注维护方式与验证结果。

